# Module 4 Exam

* [Data link](https://d396qusza40orc.cloudfront.net/gencommand/gencommand_proj4.tar.gz)

* Rules

NOTE: The genome and annotation data were obtained and modified from the Arabidopsis Information Resources (TAIR) Database, and the RNA-seq reads were extracted from GenBank’s Short Read Archive (SRA).

Create a bowtie index of the genome using bowtie2-build, with the prefix ‘athal’. Include a copy of the reference genome with the name “athal.fa” in the index directory.

**Apply to question 1-10**

> Align both RNA-seq data sets to the reference genome using tophat. Analyze the results to answer the following questions. If multiple answers are required for one question, separate the answers with a space (e.g., 1000 2000).

**Apply to question 11-20**

> Assemble the aligned RNA-seq reads into genes and transcripts using cufflinks. Use the labels ‘Day8’ and ‘Day16’, respectively, when creating identifiers. For this portion of the analysis, answer the following questions.

**Apply to question 21-30**

> Run cuffcompare on the resulting cufflinks transcripts, using the reference gene annotations provided and selecting the option '-R' to consider only the reference transcripts that overlap some input transfrag. For this step, using the *.tmap files answer the following, for both sets.

**Apply to question 31-35**

> Perform the differential gene expression analysis. For this, in a first stage run cuffmerge using the provided annotation to merge and reconcile the two sets of cufflinks transcripts. Make a note of the resulting file, ‘merged.gtf’. In a second step, use cufdiff to perform the differential expression analysis.

**NOTE:** *Note that in general at least three replicates per condition are required to establish statistical significance. The single replicate example is provided here only to illustrate the analysis.*

1. How many alignments were produced for the ‘Day8’ RNA-seq data set?
```
 % bowtie2-build ./athal_chr/athal_chr.fa ./athal_chr/athal_chr
 % tophat -o Tophat/Day8 athal/athal_chr Day8.fastq
 % samtools view Tophat/Day8/accepted_hits.bam | wc -l
```

2. How many alignments were produced for the ‘Day16’ RNA-seq data set?
```
 % tophat -o Tophat/Day16 athal/athal_chr Day16.fastq
 % samtools view Tophat/Day16/accepted_hits.bam | wc -l
```

3. How many reads were mapped in ‘Day8’ RNA-seq data set?
```
 % cat Tophat/Day8/align_summary.txt | grep Mapped
```

4. How many reads were mapped in ‘Day16’ RNA-seq data set?
```
 % cat Tophat/Day16/align_summary.txt | grep Mapped
```

5. How many reads were uniquely aligned in ‘Day8’ RNA-seq data set?
> Result from 3 question subtracted by the number of multiple alignments

6. How many reads were uniquely aligned in ‘Day16’ RNA-seq data set?
> Result from 3 question subtracted by the number of multiple alignments


7. How many spliced alignments were reported for ‘Day8’ RNA-seq data set?
```
 % samtools view Tophat/Day8/accepted_hits.bam | cut -f6 | grep -c "N" 
```

8. How many spliced alignments were reported for ‘Day16’ RNA-seq data set?
```
 % samtools view Tophat/Day16/accepted_hits.bam | cut -f6 | grep -c "N" 
```

9. How many reads were left unmapped from ‘Day8’ RNA-seq data set?
> Subtract *Mapped* number from the *Input* number given in the `align_summary.txt`

10. How many reads were left unmapped from ‘Day16’ RNA-seq data set?
> Subtract *Mapped* number from the *Input* number given in the `align_summary.txt`


11. How many genes were generated by cufflinks for Day8?


12. How many genes were generated by cufflinks for Day16?


13. How many transcripts were reported for Day8?


14. How many transcripts were reported for Day16?


15. How many single transcript genes were produced for Day8?


16. How many single transcript genes were produced for Day16?


17. How many single-exon transcripts were in the Day8 set?


18. How many single-exon transcripts were in the Day16 set?


19. How many multi-exon transcripts were in the Day8 set?


20. How many multi-exon transcripts were in the Day16 set?


21. How many cufflinks transcripts fully reconstruct annotation transcripts in Day8?


22. How many cufflinks transcripts fully reconstruct annotation transcripts in Day16?


23. How many splice variants does the gene AT4G20240 have in the Day8 sample?


24. How many splice variants does the gene AT4G20240 have in the Day16 sample?


25. How many cufflinks transcripts are partial reconstructions of reference transcripts (‘contained’)? (Day8)


26. How many cufflinks transcripts are partial reconstructions of reference transcripts (‘contained’)? (Day16)


27. How many cufflinks transcripts are novel splice variants of reference genes? (Day8)


28. How many cufflinks transcripts are novel splice variants of reference genes? (Day16)


29. How many cufflinks transcripts were formed in the introns of reference genes? (Day8)


30. How many cufflinks transcripts were formed in the introns of reference genes? (Day16)


31. How many genes (loci) were reported in the merged.gtf file?


32. How many transcripts?


33. How many genes total were included in the gene expression report from cuffdiff?


34. How many genes were detected as differentially expressed?


35. How many transcripts were differentially expressed between the two samples?


